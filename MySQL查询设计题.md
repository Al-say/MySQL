# MySQL查询设计题集

## 试卷一查询设计题（每题4分，共20分）

有关系数据库如下：
```sql
书（书号、书名，作者，价格，库存量）
读者（证件号，姓名，单位，地址）
借阅（书号，证件号，结束时间，还书时间，备注）
```
其中：某位读者的借阅记录中的"还书时间"为空白表示未还书。

1. 用SQL语言实现，查询"书名"的第三个字中包含"数"的"书号"和"书名"。（4分）

```sql
-- 在此处编写SQL语句

```

2. 用SQL语言实现，查询有未还书记录的读者"姓名"。（4分）

```sql
-- 在此处编写SQL语句

```

3. 用SQL语言实现，查询借阅人数在3个以上的"书号"和借阅人数。（4分）

```sql
-- 在此处编写SQL语句

```

4. 用SQL语言实现，建立"书名"中包含"计算机"的图书视图。（4分）

```sql
-- 在此处编写SQL语句

```

5. 用SQL语言实现，查询比《数据库原理》价格高的"书号"和"书名"（请写出连接和子查询两种查询语句）。（4分）

```sql
-- 连接查询
```

```sql
-- 子查询
```

## 试卷二查询设计题（每题4分，共20分）

假设员工管理系统中有如下数据表：
```sql
员工表(employee)：
字段：员工ID(empid)、员工姓名(empname)、入职日期(hiredate)、工资(salary)、部门ID(deptid)

部门表(department)：
字段：部门ID(deptid)、部门名称(deptname)
```

1. 向员工表中插入一条新员工记录('E008','王五','2024-02-16',5000,'D03')。（4分）

```sql
-- 在此处编写SQL语句

```

2. 查询入职时间在2020年之后，且工资高于5000的员工姓名和所在部门名称。（4分）

```sql
-- 在此处编写SQL语句

```

3. 按照部门ID分组，查询每个部门的平均工资和员工人数。（4分）

```sql
-- 在此处编写SQL语句

```

4. 将部门名称为'研发部'的员工工资统一上调10%。（4分）

```sql
-- 在此处编写SQL语句

```

5. 删除部门名称为'市场部'的所有员工记录。（4分）

```sql
-- 在此处编写SQL语句

```

## 试卷三查询设计题（每题4分，共20分）

有如下数据表：
```sql
产品表(products)：
字段：产品ID(product_id)、产品名称(product_name)、类别ID(category_id)、单价(unit_price)、库存量(stock)

订单表(orders)：
字段：订单ID(order_id)、客户ID(customer_id)、订单日期(order_date)、总金额(total_amount)

订单明细表(order_details)：
字段：订单ID(order_id)、产品ID(product_id)、数量(quantity)、单价(price)

客户表(customers)：
字段：客户ID(customer_id)、客户名称(customer_name)、等级(level)、注册日期(register_date)
```

1. 编写一个查询，统计每个产品在最近30天内的销售总额，并按销售总额降序排列。（4分）

```sql
-- 在此处编写SQL语句

```

2. 找出所有在2023年下过订单的客户中，每月平均消费金额超过1000元的客户信息。（4分）

```sql
-- 在此处编写SQL语句

```

3. 创建一个视图，显示每个类别中销售额前三的产品信息（包括产品名称、销售总额）。（4分）

```sql
-- 在此处编写SQL语句

```

4. 使用窗口函数，计算每个客户的累计消费金额，并显示每个订单占其总消费的百分比。（4分）

```sql
-- 在此处编写SQL语句

```

5. 编写一个存储过程，接收客户ID作为参数，返回该客户的消费统计信息（总订单数、总消费金额、平均每单金额）。（4分）

```sql
-- 在此处编写SQL语句
