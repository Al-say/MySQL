-- 1. 查询书名第三个字包含"数"的书号和书名
SELECT 书号, 书名
FROM 书
WHERE 书名 LIKE '__数%';

-- 2. 查询有未还书记录的读者姓名
SELECT DISTINCT 读者.姓名
FROM 读者
INNER JOIN 借阅 ON 读者.证件号 = 借阅.证件号
WHERE 借阅.还书时间 IS NULL;

-- 3. 查询借阅人数在3个以上的书号和借阅人数
SELECT 书号, COUNT(DISTINCT 证件号) AS 借阅人数
FROM 借阅
GROUP BY 书号
HAVING COUNT(DISTINCT 证件号) >= 3;

-- 4. 建立书名包含"计算机"的图书视图
CREATE VIEW 计算机图书视图 AS
SELECT 书号, 书名, 作者, 价格, 库存量
FROM 书
WHERE 书名 LIKE '%计算机%';

-- 5.1 连接查询（自连接）
SELECT a.书号, a.书名
FROM 书 a
INNER JOIN 书 b ON a.价格 > b.价格
WHERE b.书名 = '数据库原理';

-- 5.2 子查询
SELECT 书号, 书名
FROM 书
WHERE 价格 > (
    SELECT 价格
    FROM 书
    WHERE 书名 = '数据库原理'
);