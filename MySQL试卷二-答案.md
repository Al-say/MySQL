# MySQL试卷二-答案解析

## 一、选择题（20题）

1. 答案：B
   解析：数据冗余度高不是数据库系统的特点。数据库系统的特点包括数据共享性高、数据独立性高、数据一致性和完整性。

2. 答案：A
   解析：在关系模型中，关系就是一个二维表，是一个规范化了的数据结构。

3. 答案：D
   解析：SQL（Structured Query Language）是结构化查询语言，是关系数据库的标准语言。

4. 答案：A
   解析：选择（SELECT）运算是从关系中选取满足条件的元组的运算，结果是行的子集。

5. 答案：C
   解析：笛卡尔积的结果是两个关系的元组数相乘，所以是100 × 300 = 30000个元组。

6. 答案：D
   解析：数据类型完整性不是数据库的完整性约束。完整性约束包括实体完整性、参照完整性和用户定义完整性。

7. 答案：D
   解析：数据库的三级模式结构包括外模式、模式和内模式，关系模式不属于三级模式结构。

8. 答案：C
   解析：AVG函数用于计算平均值，MIN求最小值，MAX求最大值，SUM求和。

9. 答案：D
   解析：一个表可以创建多个索引，而不是只能创建一个索引。

10. 答案：A
    解析：在E-R图中，矩形表示实体，椭圆表示属性，菱形表示联系。

11. 答案：A
    解析：关系数据库规范化的主要目的是消除数据冗余和数据操作异常。

12. 答案：C
    解析：MongoDB是典型的NoSQL数据库，其他选项都是关系型数据库。

13. 答案：D
    解析：CREATE属于DDL（数据定义语言），而不是DML（数据操作语言）。

14. 答案：B
    解析：LIKE操作符用于模式匹配查询，可以使用通配符进行字符串匹配。

15. 答案：C
    解析：将E-R图转换为关系模式属于逻辑设计阶段。

16. 答案：B
    解析：层次模型使用树形结构表示实体之间的联系。

17. 答案：A
    解析：LIMIT子句用于限制查询结果返回的行数。

18. 答案：B
    解析：外键的主要作用是建立表之间的关联关系，实现参照完整性约束。

19. 答案：B
    解析：功能扩充不属于数据库实施阶段的工作。实施阶段主要包括建库、加载数据、调试等。

20. 答案：C
    解析：索引与数据库的并发控制无关。并发控制主要涉及锁、事务和死锁处理。

## 二、判断题（10分）

1. （√）解析：事务的原子性要求事务是不可分割的操作单位。

2. （√）解析：视图是虚表，不存储实际数据。

3. （√）解析：主属性不能取空值，这是实体完整性的要求。

4. （×）解析：规范化程度越高，虽然减少了数据冗余，但可能会增加查询开销。

5. （√）解析：触发器在数据变更时自动触发执行。

6. （×）解析：HAVING必须与GROUP BY一起使用。

7. （×）解析：排他锁是X锁，不是S锁。S锁是共享锁。

8. （√）解析：DISTINCT关键字用于消除重复行。

9. （√）解析：存储过程是存储在数据库服务器上的一组SQL语句。

10. （×）解析：事务以BEGIN或START TRANSACTION开始，以COMMIT或ROLLBACK结束。

## 三、SQL语句题

1. 插入员工记录：
```sql
INSERT INTO employee (empid, empname, deptid, salary)
VALUES ('E008', '王五', 'D03', 5000);
```

2. 查询2020年后入职的高薪员工：
```sql
SELECT e.empname, d.deptname
FROM employee e
JOIN department d ON e.deptid = d.deptid
WHERE e.hiredate > '2020-01-01' 
AND e.salary > 5000;
```

3. 部门工资统计：
```sql
SELECT deptid,
       COUNT(*) as 员工人数,
       AVG(salary) as 平均工资
FROM employee
GROUP BY deptid;
```

4. 研发部工资调整：
```sql
UPDATE employee e
JOIN department d ON e.deptid = d.deptid
SET e.salary = e.salary * 1.1
WHERE d.deptname = '研发部';
```

5. 删除市场部员工：
```sql
DELETE e
FROM employee e
JOIN department d ON e.deptid = d.deptid
WHERE d.deptname = '市场部';
```

## 四、数据库设计题（15分）

1. E-R图设计：
```
[图书]-(借阅)-[读者]

图书：
- 图书ID（主键）
- 书名
- 作者
- 出版社
- ISBN

读者：
- 读者ID（主键）
- 姓名
- 联系方式

借阅：
- 借书日期
- 归还日期
```

2. 关系模式转换：
```sql
图书(图书ID, 书名, 作者, 出版社, ISBN)
主键：图书ID

读者(读者ID, 姓名, 联系方式)
主键：读者ID

借阅(图书ID, 读者ID, 借书日期, 归还日期)
主键：(图书ID, 读者ID, 借书日期)
外键：图书ID引用图书表
      读者ID引用读者表
```

## 五、关系规范化题（10分）

1. R的范式级别（4分）：
- 满足1NF（所有属性都是原子的）
- 没有部分函数依赖（满足2NF）
- 不满足3NF，因为有非主属性对主键的传递函数依赖
- 所以R属于2NF

2. 3NF分解（6分）：
```
R1(A, BC)  F1={A→BC}
R2(A, E)   F2={A→E}
R3(C, D)   F3={C→D}
```

分解后：
- 消除了非主属性对主键的传递函数依赖
- 保持了数据依赖
- 无损连接分解
