# MySQL试卷三-答案解析

## 一、单选题（共20题，每题2分，共40分）

1. 答案：B
   解析：数据的物理独立性是通过模式/内模式映像实现的，使得内模式的改变不会影响到应用程序。

2. 答案：C
   解析：需求分析是数据库设计的第一个阶段，主要任务是收集和分析用户需求。

3. 答案：C
   解析：候选码是可以唯一标识一个元组的属性组，主码是从候选码中选择的一个。

4. 答案：B
   解析：事务的部分提交是错误的说法，事务要么全部提交，要么全部回滚，这是原子性的要求。

5. 答案：A
   解析：共享锁（S锁）用于防止读取不一致的数据，允许多个事务同时读取数据。

6. 答案：A
   解析：mysqldump是MySQL的备份工具，可以导出数据库或表的结构和数据。

7. 答案：D
   解析：事务完整性不属于关系数据库的完整性约束。完整性约束包括实体完整性、参照完整性和用户定义完整性。

8. 答案：C
   解析：Oracle不是MySQL支持的存储引擎。MySQL常用的存储引擎包括InnoDB、MyISAM和Memory等。

9. 答案：C
   解析：在E-R图中，菱形用来表示实体之间的联系，矩形表示实体，椭圆表示属性。

10. 答案：A
    解析：投影运算是垂直分割关系，即选择某些列组成新的关系。

11. 答案：C
    解析：MEDIAN不是SQL的聚集函数。常用的聚集函数包括COUNT、SUM、AVG、MAX、MIN。

12. 答案：B
    解析：在视图中不能使用CREATE INDEX语句，因为视图是虚表，不能建立索引。

13. 答案：B
    解析：日志文件用于保证数据库的可靠性，记录数据库的更新操作，用于故障恢复。

14. 答案：C
    解析：MERGE语句会导致表中数据发生改变，而SELECT、GRANT和CREATE INDEX不会。

15. 答案：B
    解析：规范化的主要目的是减少数据冗余，消除数据的插入、删除和更新异常。

16. 答案：B
    解析：ROLLBACK用于回滚事务，撤销事务中的所有修改。

17. 答案：B
    解析：WHERE不能跟在GROUP BY后面，但HAVING、ORDER BY和LIMIT可以。

18. 答案：B
    解析：概念模式描述了数据库的逻辑结构及其联系的集合。

19. 答案：B
    解析：SELECT不是触发器的触发事件，触发器只能响应INSERT、UPDATE和DELETE操作。

20. 答案：C
    解析：经常用于查询条件的字段最适合建立索引，可以提高查询效率。

## 二、判断题（共10题，每题1分，共10分）

1. （×）解析：数据库的逻辑独立性是通过外模式/模式映像实现的。

2. （√）解析：存储过程可以有INPUT、OUTPUT和INPUT OUTPUT类型的参数。

3. （√）解析：主键和唯一约束都可以保证字段值的唯一性，但主键不允许NULL值。

4. （√）解析：视图是根据基表定义的虚表，不存储实际数据。

5. （×）解析：表可以没有主键，但建议每个表都设置主键。

6. （√）解析：BCNF是比3NF更严格的范式，满足BCNF的关系一定满足3NF。

7. （√）解析：InnoDB存储引擎支持事务处理，具有ACID特性。

8. （√）解析：数据库备份是将数据复制到其他存储介质，以防数据丢失。

9. （√）解析：子查询可以嵌套，内层查询的结果作为外层查询的条件。

10. （√）解析：索引可以加快查询速度，但会降低更新速度，因为需要维护索引。

## 三、SQL查询题（共5题，每题4分，共20分）

1. 查询计算机科学专业学生信息：
```sql
SELECT s.学号, s.姓名, AVG(c.成绩) as 平均成绩
FROM 学生 s
LEFT JOIN 成绩 c ON s.学号 = c.学号
WHERE s.专业 = '计算机科学'
GROUP BY s.学号, s.姓名;
```

2. 查询选修三门以上课程的学生：
```sql
SELECT s.姓名
FROM 学生 s
WHERE s.学号 IN (
    SELECT 学号
    FROM 成绩
    GROUP BY 学号
    HAVING COUNT(*) >= 3
);
```

3. 查询没有不及格课程的学生：
```sql
SELECT s.姓名, AVG(c.成绩) as 平均成绩
FROM 学生 s
LEFT JOIN 成绩 c ON s.学号 = c.学号
GROUP BY s.学号, s.姓名
HAVING MIN(c.成绩) >= 60 OR MIN(c.成绩) IS NULL;
```

4. 查询选修了全部课程的学生：
```sql
SELECT s.姓名
FROM 学生 s
WHERE NOT EXISTS (
    SELECT *
    FROM 课程 c
    WHERE NOT EXISTS (
        SELECT *
        FROM 成绩 sc
        WHERE sc.学号 = s.学号
        AND sc.课程号 = c.课程号
    )
);
```

5. 创建专业统计视图：
```sql
CREATE VIEW 专业统计 AS
SELECT 专业,
       COUNT(*) as 学生人数,
       AVG(年龄) as 平均年龄
FROM 学生
GROUP BY 专业;
```

## 四、数据库设计题（20分）

1. 主要实体和联系分析（5分）：
- 实体：顾客、商品、订单
- 实体属性：
  - 顾客：用户名、密码、姓名、联系方式、送货地址
  - 商品：商品编号、名称、价格、库存量、类别
  - 订单：订单编号、下单时间、总金额、支付状态、配送状态
- 联系：顾客-订单（1:N）、订单-商品（M:N）

2. E-R图（8分）：
```
[顾客]-----(下订单)-----[订单]-----(包含)-----[商品]
  |                                              |
  |                                              |
  +-------------(评价)----------------------------|

属性：
顾客：用户名、密码、姓名、联系方式、送货地址
商品：商品编号、名称、价格、库存量、类别
订单：订单编号、下单时间、总金额、支付状态、配送状态
评价：评价内容、评价时间、评分
```

3. 关系模式转换（7分）：
```sql
顾客(用户名, 密码, 姓名, 联系方式, 送货地址)
主键：用户名

商品(商品编号, 名称, 价格, 库存量, 类别)
主键：商品编号

订单(订单编号, 用户名, 下单时间, 总金额, 支付状态, 配送状态)
主键：订单编号
外键：用户名 参照 顾客(用户名)

订单商品(订单编号, 商品编号, 数量, 实际单价)
主键：(订单编号, 商品编号)
外键：订单编号 参照 订单(订单编号)
      商品编号 参照 商品(商品编号)

商品评价(用户名, 商品编号, 评价内容, 评价时间, 评分)
主键：(用户名, 商品编号, 评价时间)
外键：用户名 参照 顾客(用户名)
      商品编号 参照 商品(商品编号)
```

## 五、关系规范化题（10分）

1. 求候选码（4分）：
- 通过分析函数依赖：AB→C, C→D, D→E, B→D
- B→D→E，所以B能推出DE
- AB能推出ABCDE
- A不能单独推出任何属性
- B能推出BDE，但不能推出AC
- 所以AB是唯一的候选码

2. 判断范式级别（2分）：
- 候选码是AB
- 主属性是A和B
- B→D是部分函数依赖（B是主属性的一部分就能确定D）
- 所以该关系模式属于1NF

3. 3NF分解（4分）：
```
R1(A, B, C)  F1={AB→C}
R2(B, D)     F2={B→D}
R3(D, E)     F3={D→E}
```
- 分解后每个关系都满足3NF
- 保持了所有的函数依赖
- 是无损连接分解
